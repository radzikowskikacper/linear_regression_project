import numpy as np

import function_to_estimate
from evaluate import print_metrics, sanity_check
from sigmoid import sigmoid, sigmoid_backward
from leaky_relu import leaky_relu, leaky_relu_backward
from relu import relu, relu_backward

layers = [2, 20, 20, 1]
L = len(layers) - 1  # number of layers - input layer doesn't count

W={}
b={}

W[1] = np.array([[ -1.11754608e+00,   2.06479724e-04],
 [ -3.26381736e+00,   4.20538690e-01],
 [ -5.93598125e+00,  -2.74454921e+01],
 [ -1.22839130e+00,   4.50714009e+00],
 [ -4.35885465e+00,  -2.02643826e+01],
 [ -2.34273651e+00,   6.25955582e-01],
 [  2.83384974e+00,  -7.33502245e-01],
 [ -4.58291512e+00,   1.49097194e-01],
 [  1.60548305e+00,   1.34065570e+01],
 [ -1.62752827e+00,   3.40793646e-01],
 [ -3.99071657e+00,   1.38752686e-03],
 [ -4.22288295e+00,   2.89969099e+00],
 [ -2.07427693e+00,  -3.94134113e+00],
 [ -3.45126915e+00,  -5.05827518e-02],
 [ -1.20416942e+00,  -2.32754666e+00],
 [  8.84307083e-01,  -3.49659541e+00],
 [ -2.74980683e-01,  -1.69725179e+00],
 [ -7.10819994e-01,  -2.28981854e-02],
 [ -6.45308217e-01,   3.80682152e-01],
 [ -5.16277236e+00,   7.21879726e+00]])

W[2] = np.array([[ -1.05011910e-02,  -1.23864473e-02,  -1.85345169e-02,  -6.77746098e-03,
   -4.28940280e-03,  -2.39052315e-02,  -1.84531703e-02,   7.38719242e-03,
   -1.38990985e-02,  -1.21207278e-03,  -2.27020954e-02,  -3.92602706e-02,
   -2.46674445e-02,  -4.52175830e-03,  -1.58498086e-02,  -7.37469999e-03,
    4.72480009e-03,   5.55852782e-03,  -2.32357563e-03,  -6.53745784e-02],
 [ -3.61753321e-02,  -9.44110002e-02,  -3.45510343e-02,  -4.30213054e-02,
   -1.39355098e-02,  -6.46431282e-02,  -3.07929249e-02,  -3.57172478e-02,
   -4.88157489e-02,  -2.21936982e-02,  -4.23270867e-02,  -1.23456974e-02,
   -5.07196640e-02,  -3.34278212e-02,  -1.21098868e-02,  -1.07103531e-01,
   -2.57369177e-02,   3.97323066e-03,  -3.41584773e-03,   2.34640270e-03],
 [ -1.59598217e-01,  -2.20983203e-01,  -1.19195881e-01,  -9.35970294e-01,
    5.63242307e-03,  -3.17492920e-01,  -6.23728353e-01,  -9.11723852e-01,
   -2.03220314e+00,  -1.98160747e-02,  -6.81756313e-02,  -5.34420363e-02,
   -2.19454618e-01,  -1.32234318e-01,  -1.34217055e-01,  -1.78546521e+00,
   -1.63338854e-03,  -1.45760023e-02,  -1.52296729e-02,  -3.26366597e-01],
 [ -1.46192110e-01,  -1.99072267e-01,  -5.00179128e-01,  -3.07721168e-01,
   -2.97136556e-01,  -3.19958513e-01,  -4.19121104e-01,  -5.15612281e-01,
   -4.83324238e-01,  -1.72408107e-01,  -9.81235618e-02,  -6.86290003e-02,
   -6.54813001e-01,  -2.13394694e-01,  -4.54295271e-01,  -1.49543004e+00,
   -1.09470776e-01,  -9.90190783e-02,  -3.97853475e-02,  -8.92641785e-01],
 [ -6.23860542e-02,  -1.77709550e-01,  -4.93061376e-03,  -6.46713451e-01,
    4.69791730e-03,  -1.17242891e-01,  -4.46231353e-01,  -5.24949189e-01,
   -5.74561180e-01,  -1.05396969e-02,  -5.30856404e-02,  -4.57646437e-02,
   -2.18774053e-01,  -6.02264076e-02,  -1.27828466e-01,  -9.99563154e-01,
   -5.40351369e-02,  -2.03148390e-02,   3.36172449e-03,  -2.72290946e-01],
 [ -1.26281435e-01,  -1.39658944e-01,  -1.00581574e-01,   7.26911198e-02,
   -3.66355970e-02,  -3.40890287e-01,  -2.57514171e-01,   3.44272134e-02,
   -4.37087374e-01,  -1.36692657e-01,  -1.44052737e-01,  -4.60214120e-02,
    1.13228647e-01,  -2.57987525e-01,  -4.37415141e-02,  -1.06264744e+00,
    1.12537386e-01,  -1.74080382e-02,  -4.61253618e-03,  -2.27588995e-01],
 [ -3.05852909e-02,  -9.09193402e-02,  -3.16396793e-02,  -3.80412033e-02,
   -1.14770663e-02,  -5.69140518e-02,  -2.19265210e-02,  -4.21030198e-02,
   -3.75504027e-02,  -2.54810178e-02,  -2.87997566e-02,   4.38623341e-03,
   -1.93184440e-02,  -3.43218118e-02,  -1.17712849e-02,  -6.77513710e-02,
   -4.93725201e-03,  -6.24968361e-03,   2.46582543e-03,  -4.59546220e-03],
 [ -3.08233425e-02,  -5.00900903e-03,  -2.17005737e-02,  -1.58239369e-02,
   -1.60455342e-02,  -4.13161145e-02,  -3.11251066e-02,  -2.92144649e-02,
   -5.29729284e-02,  -1.62601719e-02,  -4.02226276e-02,  -5.89224474e-02,
   -1.54921274e-02,   1.88534232e-02,  -2.43924039e-02,  -7.57112259e-03,
    3.63237834e-03,  -4.07341477e-03,  -2.12463850e-03,  -1.21449813e-01],
 [ -1.13781472e-01,  -1.31104525e-01,  -1.34213311e-01,  -9.21295868e-02,
   -7.49728378e-02,  -2.33438158e-01,  -6.63971436e-02,  -1.70055340e-01,
   -1.97363991e-01,   6.44330555e-02,   2.45978823e-01,  -3.31180783e-01,
   -1.38139981e-01,  -6.90128687e-02,   3.99523368e-02,  -9.68873847e-02,
   -3.86114754e-03,  -3.29693903e-02,   6.27543443e-02,  -5.85183309e-01],
 [ -3.44268871e-02,  -1.22840756e+00,  -2.91205810e-01,  -7.87384465e-01,
   -2.16025013e-01,  -1.41390373e-01,  -1.56700914e+00,  -8.28939160e-01,
   -2.72905173e+00,  -7.75291186e-02,   6.53802889e-02,  -8.66069032e-02,
   -1.83058068e+00,  -8.74469126e-02,  -1.63364526e-02,  -3.94746944e+00,
   -7.99659450e-01,  -2.95121443e-02,  -6.46201027e-02,  -3.96538289e-01],
 [ -1.05365740e-01,  -1.08350921e-01,  -1.92715364e-01,   1.04081720e-01,
   -8.35787137e-02,  -2.41259201e-01,  -1.81378685e-01,  -1.24190838e-01,
   -2.69644492e-01,  -1.38435061e-01,  -1.68285894e-01,  -1.26720831e-01,
   -2.49638248e-01,  -1.16629174e-01,  -1.83574912e-01,  -9.56820619e-01,
    3.03762903e-02,  -3.60718209e-02,  -2.08578665e-02,  -7.72324984e-01],
 [ -2.24239343e-02,  -1.44498644e-02,  -2.21685911e-02,  -3.26332097e-02,
   -1.15403219e-02,  -3.52311532e-02,  -8.33872936e-03,  -3.15263810e-02,
   -3.70338107e-02,  -2.46492490e-02,  -5.19250165e-02,  -7.87314048e-02,
   -2.77745714e-02,   1.22846690e-02,  -4.14074321e-02,  -5.77264523e-03,
   -2.21570178e-02,   3.99924123e-03,  -1.40539028e-02,  -1.81742769e-01],
 [ -1.56860667e-01,  -3.95227002e-01,  -7.43388544e-01,   6.50892125e-01,
   -5.42837859e-01,  -2.95823483e-01,  -4.84352290e-01,  -3.91932704e-01,
   -1.15395633e+00,  -4.35641047e-01,  -5.98960875e-01,  -8.98690883e-01,
    1.44733139e-01,  -5.22129512e-01,   2.17087324e-01,  -5.07995805e-01,
   -1.83177852e-01,  -9.50359457e-02,  -1.13628989e-01,  -1.86240018e+00],
 [ -1.25342209e-01,  -3.84368876e-01,  -3.71870569e-01,  -1.07321143e-01,
   -1.88080381e-01,  -2.84229626e-01,  -2.99165229e-01,  -4.68177647e-01,
   -4.70597607e-01,  -4.31058844e-02,  -1.04717559e-01,  -7.71629076e-02,
   -4.31373461e-01,  -1.43159999e-01,  -2.63386045e-01,  -4.24019538e+00,
   -2.02836420e-01,  -2.20106533e-02,  -1.76564687e-02,  -3.39129374e-01],
 [ -1.64350538e-01,  -5.56408014e-01,  -7.68848066e-02,  -2.93890125e-01,
   -5.30653818e-02,  -3.18313926e-01,  -7.61039066e-02,  -7.28370150e-01,
   -1.97302930e-01,  -2.26647783e-01,  -5.94047943e-01,  -5.36550402e-01,
   -5.31614380e-01,  -5.28490013e-01,  -2.69355183e-01,  -1.66115479e-01,
   -1.06555499e-01,  -1.26887975e-01,  -1.05047618e-01,  -7.85201583e-01],
 [ -1.24386104e-01,  -9.53571044e-02,  -1.11996401e-01,  -1.94335803e-03,
   -2.77930367e-02,  -2.69767609e-01,  -2.17464185e-01,  -1.42939181e-01,
   -2.01220689e-01,  -8.42558693e-02,  -6.48398107e-02,  -3.46778284e-02,
   -3.74239623e-02,  -1.29364846e-01,  -6.06680725e-02,  -1.12568030e+00,
    3.71628797e-02,  -1.39011945e-02,  -1.02972292e-02,  -4.15791270e-01],
 [ -7.48932527e-02,  -9.52081373e-02,  -1.00402097e-01,  -7.05761845e-02,
   -4.11647566e-02,  -1.29329462e-01,  -3.47162882e-02,  -1.29498631e-01,
   -1.12305908e-01,   1.22238240e-02,   8.21569216e-02,  -2.10743661e-01,
   -8.84018456e-02,  -4.80443510e-02,   2.27285397e-02,  -7.43248615e-02,
    1.24757765e-02,  -2.80597774e-02,  -1.60194191e-03,  -3.77376630e-01],
 [ -4.09680683e-01,  -1.10179431e+00,  -2.90339637e+01,  -1.37217691e+01,
   -2.13965924e+01,  -9.00198203e-01,  -1.08239576e+00,  -1.62591552e+00,
   -1.38863289e+01,  -7.30940720e-01,  -1.43798263e+00,  -1.89738030e+00,
   -4.20803968e+00,  -1.26396104e+00,  -3.98099263e+00,  -3.50854951e+00,
   -1.92408016e+00,  -2.63920567e-01,  -3.27055083e-01,  -1.00805022e+01],
 [ -1.92414428e-01,  -1.67320787e-01,  -2.37272242e-01,  -1.52683318e+00,
   -9.36826092e-02,  -3.62227049e-01,  -3.87374302e-01,  -8.15902946e-01,
   -1.11462856e+00,  -2.20111006e-02,  -7.28076617e-02,  -4.92953592e-02,
   -1.28298949e-01,  -1.22600369e-01,  -1.24885138e-01,  -9.22757018e-01,
    9.37202068e-04,  -9.52979379e-03,  -5.73613479e-03,  -3.18365351e-01],
 [ -1.44886771e-02,  -1.21545978e-02,  -1.95598426e-02,  -2.38430914e-02,
    1.29663636e-02,  -2.47803546e-02,  -1.59306507e-02,  -1.65690362e-02,
   -2.62096958e-02,  -9.79594206e-03,  -6.91003207e-03,  -9.16969191e-03,
   -1.18652524e-02,  -1.21284351e-02,   9.11319756e-04,  -2.30520149e-02,
   -3.06261641e-03,   8.28587717e-03,   5.38717235e-03,  -2.08126802e-02]])

W[3] = np.array([[ -0.07530199,   0.15971169,  -0.52157064,   0.53588587,   0.32086437,
    1.17003868,   0.12927958,   0.02480104,  -0.37981471,   1.25249033,
    0.42719705,  -0.19633806,  -1.33666461,   1.96234792,  -0.85143148,
    0.29316975,  -0.32490111,  20.73010846,   0.71486358,   0.06467148]])

b[1] = np.array([[ -0.1021051 ],
 [  0.66061045],
 [ -4.29980739],
 [  7.69381494],
 [ -3.21811716],
 [  0.08029981],
 [-23.08271673],
 [  2.12603823],
 [  4.91424665],
 [  0.56601024],
 [ -0.66863608],
 [ -2.49525672],
 [  0.95161317],
 [  0.37812204],
 [ -0.67524629],
 [  0.44579829],
 [  0.70564372],
 [ -0.19954825],
 [ -0.2847129 ],
 [ -6.12655136]])

b[2] = np.array([[ -1.10876343e-02],
 [ -1.95264355e-02],
 [  4.41890116e+00],
 [  4.92569351e+00],
 [  3.93703649e+00],
 [  2.07427934e+00],
 [ -1.23342502e-02],
 [ -2.96277127e-06],
 [ -2.76013086e-02],
 [  1.21231751e+01],
 [  1.80220367e+00],
 [ -1.43065859e-02],
 [  1.87590198e+00],
 [  2.07462394e+00],
 [ -2.67912833e-02],
 [  2.26470113e+00],
 [ -1.29192400e-02],
 [ -1.94272279e+00],
 [  4.06882437e+00],
 [ -8.68469675e-03]])

b[3] = np.array([[-0.1449533]])

activation_fun = {'forward': relu, 'backward': relu_backward}

sanity_check(L, W, b, activation_fun, function_to_estimate.function1)
print_metrics(layers, W, b, activation_fun)
