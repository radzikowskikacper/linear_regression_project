import numpy as np

import function_to_estimate
from evaluate import print_metrics, sanity_check
from sigmoid import sigmoid, sigmoid_backward
from leaky_relu import leaky_relu, leaky_relu_backward
from relu import relu, relu_backward

layers = [2, 20, 20, 1]
L = len(layers) - 1  # number of layers - input layer doesn't count

W={}
b={}

W[1] = np.array([[  6.56908628e-01,   1.24488096e-01],
 [ -5.23100046e-01,   6.57094447e-02],
 [  5.12492908e-01,  -9.78950104e-01],
 [  1.05881467e+00,   2.95757507e-02],
 [  1.77353820e-01,   2.87540906e-01],
 [  6.16571973e-02,  -1.72902639e+00],
 [ -1.03945754e+00,   1.81255777e-03],
 [  1.27477781e+00,   1.39916686e-02],
 [ -5.35018966e-01,   1.09260726e-02],
 [ -3.50413408e-01,   1.89357471e+00],
 [ -6.77852627e-01,  -1.50968614e-02],
 [ -1.04196083e+00,   5.51194319e-02],
 [ -4.36786252e-02,  -2.13242333e+00],
 [ -6.26521268e-01,  -7.34729739e-02],
 [ -9.36451679e-01,   1.11819358e-01],
 [  6.21080732e-01,   2.93542377e-03],
 [ -1.31438601e+00,   4.99025122e-03],
 [ -8.38714176e-01,   9.50635615e-02],
 [ -8.26960341e-01,  -3.51613081e-05],
 [  9.18582372e-01,  -1.29224878e-02]])

W[2] = np.array([[  6.16756987e-01,   1.50439340e+00,  -1.24426750e-01,  -2.68591217e+00,
   -1.11170481e+00,   8.62197365e-01,   6.02472299e-01,  -2.88406208e+00,
    3.26875594e+00,  -2.76298688e+00,   5.24793332e-01,   2.32851599e+00,
    1.56952475e+00,   1.49540880e+00,   1.60289119e+00,  -2.95992945e+00,
    4.75992789e-01,   9.02624143e-01,   6.50067238e-01,  -4.93914838e-02],
 [ -3.18210160e+00,   2.39366332e+00,   4.22829575e+00,  -1.66616709e+00,
    3.15798325e-01,   3.94761167e+00,   1.56920908e+00,  -1.66148683e+00,
    2.04017498e+00,   2.08666590e-01,   1.86996131e+00,  -3.29634063e-02,
    9.24988549e-01,   1.78266824e+00,   3.92981217e-01,  -1.96715490e+00,
    2.22713110e+00,   8.69674266e-01,   1.42549698e+00,  -2.95465222e+00],
 [ -8.70751340e-01,  -5.98720456e-02,   1.00785561e+00,  -9.13675727e-01,
   -3.00471984e-01,   1.60578514e-01,  -1.83110303e-01,   1.47256075e+00,
    7.01982195e-01,  -3.19915416e+00,  -3.49417014e-01,  -3.10869812e+00,
    2.02311636e+00,  -6.52450418e-02,   6.53965712e-01,  -2.00620778e+00,
   -8.03861929e-02,   1.08133024e+00,  -1.14514087e-01,  -1.24797043e+00],
 [ -5.76889220e-01,   2.64119528e-01,  -1.92361938e+00,  -2.32076014e+00,
    2.21260565e+00,  -2.92810474e+00,   2.66878674e-01,  -2.81538750e+00,
    2.25970656e-01,  -7.01525758e-01,  -3.14202758e-01,   6.88074844e-01,
   -2.24630412e+00,   2.72389317e-01,   3.79316387e-01,  -2.21276928e+00,
   -5.11496229e-02,   3.16388271e-01,   2.24374984e-01,  -8.63427935e-01],
 [ -5.18816426e-01,   1.13565462e-01,  -7.10141967e-01,  -1.31199108e+00,
    4.67270542e-01,  -2.39849336e-01,   7.12329143e-01,   3.43320606e-01,
   -6.69836304e-01,  -1.73185547e+00,   1.94356724e-01,  -2.54726184e+00,
    6.81669082e-01,  -1.86564822e-01,   2.02002599e+00,  -1.23587711e+00,
    1.29604396e+00,   2.57922220e-01,   7.36836731e-01,  -9.71456853e-01],
 [ -2.14028528e+00,   1.12115673e+00,  -3.17316028e-01,   1.91294706e+00,
    3.98833715e-02,  -1.83426675e+00,   3.71267876e-01,   4.05756146e+00,
   -8.40475706e-01,   7.31671791e-02,   1.26220184e+00,  -1.93404926e+00,
   -3.13557225e+00,  -3.46786222e-01,   1.17754994e+00,  -3.48789698e-01,
    1.10293002e+00,   1.12969271e+00,   1.19958580e+00,  -3.25817647e+00],
 [ -5.19738330e-01,   1.40975050e+00,   1.10231787e+00,  -5.49204848e-02,
   -1.57593909e+00,   2.60799179e+00,   1.93853665e+00,  -1.19457461e-01,
    3.38574354e-01,   1.54755685e+00,   2.15488257e+00,   1.43906924e-02,
    3.94101132e+00,   8.81577016e-01,   2.36977649e+00,  -2.22838584e-01,
    1.81719488e+00,   1.96213096e-01,   1.86176981e+00,  -3.60280462e-01],
 [ -6.45918523e-01,   5.83651645e-01,  -1.61689167e-01,  -2.52980801e+00,
   -3.22484360e-01,   8.10242215e-01,   4.91788188e-01,  -1.69544082e+00,
    1.92664585e+00,  -3.33687111e+00,   1.77297568e-01,  -3.12786771e-01,
    1.98615974e+00,   5.76711672e-01,   1.02569049e+00,  -3.13991611e+00,
    5.56491317e-01,   1.06492287e+00,   5.11823316e-01,  -4.75770965e-01],
 [ -7.42354017e-01,  -3.40332292e-02,   9.21032019e-01,  -9.22188132e-01,
   -3.46546576e-01,   1.45424810e-01,  -1.33528032e-01,   1.32312910e+00,
    4.88986415e-01,  -3.10648711e+00,  -2.90503427e-01,  -3.03001850e+00,
    2.02592005e+00,  -5.06121005e-02,   7.04668226e-01,  -1.83840091e+00,
    1.74528534e-02,   9.04044280e-01,  -1.30864840e-02,  -1.15002767e+00],
 [ -1.06489428e+00,   2.94358886e-01,  -1.92373002e+00,  -3.41108947e+00,
    9.35391585e-01,  -2.41347873e+00,   1.34053357e-01,  -4.75026107e+00,
    3.61805744e-03,  -9.69909603e-01,  -4.40476424e-01,   1.34797157e-01,
   -2.48780311e+00,   3.41944947e-01,   1.53157934e-01,  -1.90861222e+00,
   -3.59282129e-01,   2.49337827e-01,   8.93167558e-02,  -1.13890078e+00],
 [ -1.02803386e+00,   1.98478553e+00,   2.73013966e+00,  -2.21656827e+00,
    3.74856054e-01,   2.46727385e+00,   1.14284698e+00,  -2.15775332e+00,
    4.11402478e+00,  -6.12123208e-01,   1.10180985e+00,   9.94913910e-01,
    2.23099402e+00,   1.60548098e+00,   9.24246785e-01,  -3.13187968e+00,
    1.64761633e+00,  -5.23635324e-02,   1.47424061e+00,  -2.43189007e+00],
 [ -1.19487278e+00,   2.73227794e-01,  -1.95093296e+00,  -4.02000246e+00,
    9.00332177e-01,  -2.44463161e+00,   1.14304042e-01,  -5.13464839e+00,
    2.66395589e-03,  -1.04119347e+00,  -4.78303928e-01,   3.05374393e-01,
   -2.61289500e+00,   3.30167778e-01,   1.08863387e-01,  -1.97448029e+00,
   -4.20325641e-01,   2.40267978e-01,   8.10772194e-02,  -1.18011940e+00],
 [ -1.03411041e-01,   1.11335685e+00,  -1.43255005e-01,  -2.68537445e+00,
    1.99028398e-01,   6.42599501e-01,   8.16619618e-01,  -1.34995903e+00,
    1.36269286e+00,  -3.76480406e+00,   3.99848975e-01,  -1.83859890e-01,
    1.83583763e+00,   1.29484861e+00,   1.09241172e+00,  -2.99604896e+00,
    4.63527947e-01,   1.54533540e+00,   7.96629564e-01,  -4.30032576e-01],
 [ -2.16365420e+00,   1.05995367e+00,  -6.63677821e-01,   2.30359008e+00,
    7.49905090e-01,  -2.82244897e+00,   1.92741588e+00,   3.18049833e+00,
    8.09185931e-02,  -1.34127743e+00,   1.29413629e+00,  -3.11204441e+00,
   -3.42356559e+00,   7.61001765e-01,   7.96985635e-01,  -1.00465889e+00,
    2.22973282e+00,   8.67956746e-01,   1.66844860e+00,  -2.69416185e+00],
 [ -4.36166429e-01,  -1.76536458e-01,  -5.96352096e-01,  -1.35673228e+00,
    2.99649163e-01,   1.91648241e-01,   4.22284612e-01,  -4.82091397e-01,
    2.43693240e-01,  -1.29299788e+00,   1.74834605e-01,  -1.53278378e+00,
    3.85973976e-01,  -1.71186997e-01,   8.20748477e-01,  -2.38947075e+00,
    7.62695543e-01,   2.74114203e-01,   3.24333013e-01,  -8.47715557e-01],
 [ -1.32875131e+00,  -3.80588615e-01,  -1.71337004e-01,  -1.23677894e-01,
    1.90633803e-01,   8.43285357e-01,   1.42517227e-02,   2.90763672e+00,
   -3.28560086e+00,  -2.07512405e-01,   9.28815162e-01,  -2.86496858e+00,
    4.17649155e+00,  -1.20099026e+00,  -4.54048184e-01,   1.39727240e+00,
   -7.40667884e-02,  -2.19842520e+00,   1.13470037e+00,  -3.99548312e-01],
 [ -5.00750586e-01,   5.28532998e-01,  -3.84691317e-01,  -4.97641949e-01,
    1.06006039e-01,  -5.93595116e-01,   9.53645423e-01,  -5.59174703e-01,
    1.25651286e-01,   2.87296164e-01,   1.04351028e+00,  -1.37360018e+00,
   -3.58241394e-02,   2.42611808e-01,   1.61776290e+00,  -5.81103132e-01,
    1.79120183e+00,   1.87818496e-01,   1.15749074e+00,  -8.17050531e-01],
 [  6.30443353e-01,  -1.41624588e+00,  -6.79690329e-01,   1.54105978e+00,
   -1.71744722e-01,  -1.22683478e+00,  -5.28387576e-01,   2.03140406e+00,
   -1.95406916e+00,   1.89376232e+00,  -5.91666776e-01,  -1.25496245e+00,
   -1.26002625e+00,  -1.60879377e+00,  -8.18530542e-01,   1.69938621e+00,
   -2.45338860e-01,  -4.85339503e-01,  -6.43802407e-01,   7.97193079e-01],
 [ -1.90789629e+00,  -1.08722363e+00,  -5.73870973e-01,   1.91168450e-01,
    9.00077272e-01,   1.31218476e+00,  -1.37023511e+00,   3.26998929e+00,
   -9.26652226e-01,  -2.08786543e+00,  -1.32418907e+00,  -3.00825746e+00,
    2.91000770e+00,  -1.12474203e+00,  -3.53795238e-01,   4.78575822e-01,
   -1.65680629e+00,   1.94531310e+00,  -1.33383375e+00,  -3.08167269e+00],
 [ -1.63284627e+00,  -3.52236259e-01,   4.11410560e-01,  -1.64885114e-01,
    1.98545635e-01,   2.52570013e-01,   3.13265472e-01,   2.20906390e+00,
   -3.02627802e+00,  -2.00536501e+00,   1.36545683e-01,  -2.90799021e+00,
    2.88995397e+00,  -3.09052858e-01,   4.01683594e-02,   5.13516352e-01,
   -4.68033801e-01,  -9.60673410e-01,   6.11402245e-01,  -6.68086208e-01]])

W[3] = np.array([[ 5.3811767 , -9.51110481,  1.31373075,  3.90547895, -2.03479374,
   5.3915286 ,  6.54612355,  2.48787067,  1.01772159,  5.95769561,
  -8.56478038,  6.40700182,  2.42120779,  5.54794237, -2.76512586,
   5.87014004,  0.83642698, -3.56258744,  4.92196823,  2.98161173]])

b[1] = np.array([[  0.26638568],
 [  3.67651873],
 [ -3.07523146],
 [ 18.72760351],
 [  4.71397749],
 [ -0.08177133],
 [ 15.44551254],
 [ 18.9994958 ],
 [ -4.44785686],
 [ -4.52942433],
 [  6.92119164],
 [-18.75280298],
 [ -0.28314559],
 [  3.50764887],
 [  2.73030461],
 [  7.20096099],
 [ 23.86600602],
 [ -1.34396089],
 [ 10.03304258],
 [  2.34594324]])

b[2] = np.array([[-0.46811298],
 [-0.90986905],
 [-1.09072326],
 [-0.6992247 ],
 [-0.60268521],
 [-2.51634936],
 [-0.18047068],
 [-0.46294904],
 [-1.05194198],
 [-0.84184614],
 [-1.52402002],
 [-0.88165245],
 [-0.191445  ],
 [-2.04669901],
 [-0.57991316],
 [-3.17935166],
 [-0.48227408],
 [ 1.12227386],
 [-2.42903918],
 [-2.57944704]])

b[3] = np.array([[-7.5737848]])

activation_fun = {'forward': sigmoid, 'backward': sigmoid_backward}

sanity_check(L, W, b, activation_fun, function_to_estimate.function1)
print_metrics(layers, W, b, activation_fun)
