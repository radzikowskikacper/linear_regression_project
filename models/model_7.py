import numpy as np

import function_to_estimate
from evaluate import print_metrics, sanity_check
from sigmoid import sigmoid, sigmoid_backward
from leaky_relu import leaky_relu, leaky_relu_backward
from relu import relu, relu_backward

layers = [2, 20, 20, 1]
L = len(layers) - 1  # number of layers - input layer doesn't count

W={}
b={}

W[1] = np.array([[ 0.16585984, -0.00338999],
 [-0.49621098, -0.3277488 ],
 [ 0.19751614, -0.00201377],
 [ 0.29235067,  0.65970793],
 [-0.19583734, -0.37936446],
 [ 0.0871979 ,  0.09423701],
 [-0.53270243, -0.29545824],
 [ 0.11492498, -0.35560047],
 [ 0.11899153, -0.11778696],
 [-0.28393364,  0.41248423],
 [-0.36508148, -0.00418881],
 [ 0.38671095, -0.00726134],
 [ 0.13660695,  0.02391397],
 [-0.25458366, -0.01630698],
 [-0.45147671,  0.54004193],
 [-0.33470557,  0.05922051],
 [ 0.01284559, -0.4483207 ],
 [-0.21014998,  0.8928874 ],
 [-0.30619105,  0.37438779],
 [ 0.42700366,  0.30538763]])

W[2] = np.array([[ 0.10691734, -0.24825526,  0.13448326, -0.09235393, -0.49989945,
   0.10462696, -0.09926365,  0.46964389,  0.03288504,  0.01665761,
   0.33475532, -0.09675323,  0.15550159, -0.42613342,  0.03687153,
   0.11204949,  0.21876962,  0.7201441 ,  0.12389433,  0.04223951],
 [ 0.05739237,  0.18272672,  0.11352397,  1.17481743,  0.11859888,
   0.26597833,  0.17206923, -0.2275908 , -0.05141345, -0.0858234 ,
  -0.5743885 , -0.26721639,  0.1705269 , -0.27234795, -0.38508851,
  -0.24895836, -0.13098659, -1.08623872, -0.1966202 ,  0.38875449],
 [ 0.04022862,  1.34308235,  0.09284559,  1.32965152,  0.17329127,
   0.29197163,  0.55990143, -0.08117618,  0.05350404, -0.50229277,
   0.12377892, -0.04719425,  0.17551173,  0.16841726, -0.78139108,
   1.02890326,  0.39472544, -0.64674544, -0.33831116,  0.85712072],
 [-0.00405228,  0.80401968,  0.04285371, -0.07291814,  0.52515632,
   0.13925784,  0.49809202,  0.18650858,  0.19096261, -0.33278797,
  -1.26735042,  0.5670984 ,  0.01410536,  0.38627797, -0.51474421,
  -0.59491402, -0.18743267, -0.59739219, -0.70802679,  0.90889908],
 [ 0.01555021, -0.62812223,  0.01233278, -0.18996839, -0.30459934,
  -0.07386634, -0.43992074, -0.15745616,  0.30682977,  0.35078714,
  -0.34939663,  0.90069124, -0.18953229, -0.23714143,  0.95909665,
  -0.6924996 , -0.26344882,  0.3760211 ,  0.47998112,  0.52712976],
 [-0.05047992, -0.29543958, -0.05056957, -0.13092269,  0.04446419,
  -0.07295873, -0.16598581, -0.09818753, -0.01382126,  0.11772884,
  -0.23955076,  0.19489936, -0.12386033, -0.02080519, -0.06230514,
  -0.30770777, -0.05743076,  0.50993707, -0.00658768,  0.0865954 ],
 [ 0.18168449,  0.20060996,  0.2585301 ,  0.58655842, -0.0228349 ,
   0.30399128,  0.14218337, -0.09461799,  0.04923973, -0.24347319,
  -0.42470278,  0.06073544,  0.29286497, -0.20106366, -0.40605799,
  -0.18653912,  0.01541156, -0.84183718, -0.22611357,  0.5645488 ],
 [ 0.03789047, -0.2277146 ,  0.08730075, -0.00448802, -0.88647432,
   0.06341557, -0.06691008,  0.57623077,  0.03744695, -0.27503477,
   0.17048213,  0.04438372,  0.0456307 , -0.38100642, -0.56887474,
   0.02106584,  0.26728098,  0.6348225 , -0.31935521,  0.2259741 ],
 [-0.06989419, -0.04597243, -0.0878046 , -0.05753021, -0.15150409,
  -0.07666168, -0.06109883, -0.00655581, -0.02289049,  0.03556361,
  -0.04449217, -0.06099254, -0.07421993,  0.03860833,  0.03243585,
  -0.02786776,  0.01530258,  0.1483597 ,  0.02600395, -0.10434411],
 [-0.0051567 ,  0.3065222 ,  0.00520868,  0.07219289,  0.37647705,
   0.04137039,  0.24886218,  0.1043781 ,  0.08863776, -0.16735528,
  -0.55993736,  0.36393762, -0.02186122,  0.34923577, -0.22343136,
  -0.3016015 , -0.10798558, -0.43952647, -0.39419995,  0.40111556],
 [-0.08692686,  0.05302393, -0.10381461, -0.07436704, -0.15161477,
  -0.08106833,  0.05079584,  0.0782592 ,  0.02025642, -0.05711234,
   0.05063253, -0.03641251, -0.14306373,  0.23839139, -0.05083855,
   0.01675506,  0.23263451,  0.23205758, -0.03280926, -0.083938  ],
 [ 0.00462633, -0.59312614,  0.03188143,  0.10300716, -0.91016717,
  -0.17421976,  0.15238756,  1.24510229,  0.64078517,  0.91597876,
   0.9452248 ,  0.43495123, -0.03013193, -0.59913171,  0.86372448,
   0.37293648,  0.45853105,  0.12529628,  0.5553756 ,  0.20711291],
 [ 0.15452861, -0.17772538,  0.20861675, -0.110916  , -0.61608748,
   0.15540383, -0.03678057,  0.59221271,  0.10752913,  0.11552738,
   0.5705307 , -0.0258752 ,  0.23695065, -0.51293341,  0.16653632,
   0.25062463,  0.25346152,  0.74136232,  0.21594607,  0.12239274],
 [ 0.20869341, -0.32103551,  0.23128371, -0.63174051,  0.24820685,
   0.166542  , -0.41286777,  0.71899261,  0.47196391,  0.99169285,
  -0.46125713, -0.53864407,  0.20829985, -0.81436792,  0.71194609,
  -0.90822518, -0.52861707, -1.10694042,  0.20334079, -1.05511613],
 [-0.02694487,  0.00749014, -0.03172062, -0.0282159 ,  0.41497851,
  -0.01918746,  0.09284699, -0.19104484,  0.04378457,  0.11777853,
  -0.06364163, -0.00236565, -0.02474131,  0.07796988,  0.10817238,
  -0.02393766, -0.21542713, -0.55608933,  0.00865849, -0.1470815 ],
 [ 0.08025133,  0.77283358,  0.13123759,  0.77640271,  0.09199761,
   0.2304643 ,  0.39525236, -0.06137556,  0.05357464, -0.42643378,
   0.25096972,  0.21555436,  0.16293637,  0.14806006, -0.55899691,
   0.67607481,  0.16239239, -0.1499933 , -0.18288811,  0.73300227],
 [-0.00628606,  0.01928539, -0.02014372,  0.0038161 , -0.03467243,
   0.00705059,  0.01142497, -0.02460608,  0.00290754, -0.00534696,
   0.02014715, -0.00992867,  0.00791943, -0.00703823,  0.01316498,
   0.02402786,  0.03456492, -0.0036353 , -0.02151432, -0.00467754],
 [ 0.23190118,  0.36706332,  0.26101445,  0.08774769,  0.13066023,
   0.46801638, -0.40118083,  0.13779258,  0.24960487, -0.43370004,
  -1.43166838,  0.1066298 ,  0.29728896, -0.06488276, -0.54335958,
  -0.34111555,  0.09068242,  0.50155081, -0.74260422,  0.30862497],
 [-0.16660401, -0.7084133 , -0.18761111, -0.28416463, -0.15489353,
  -0.19675898, -0.23852644, -0.22837607,  0.06819765,  0.28665226,
  -0.32574475,  1.06030618, -0.35436563, -0.3076511 ,  0.27688637,
  -0.6971728 , -0.20028423,  0.81801602,  0.28767183,  0.45639043],
 [ 0.02700658,  0.17219972,  0.03832688,  0.24133696,  0.12698596,
   0.05798985,  0.0782216 , -0.01249419,  0.00761969, -0.16564691,
   0.05185651,  0.06541938,  0.06050266,  0.04788548, -0.17308478,
   0.13533488,  0.03296991, -0.07915571, -0.0381769 ,  0.17657634]])

W[3] = np.array([[ 0.61984072, -1.33816584, -1.26794943,  1.43909389, -1.08759368,
  -0.45126297, -0.97994798,  1.06559681, -0.22526656,  0.87624971,
  -0.31068317,  1.06394305,  0.77311419, -3.70639416,  0.75102803,
  -0.92972606, -0.055688  ,  1.277751  , -1.00379754, -0.3127362 ]])

b[1] = np.array([[ 0.44555787],
 [-1.91556035],
 [ 0.49714112],
 [-4.86864045],
 [ 2.51025688],
 [ 0.50740872],
 [-0.52428376],
 [-1.45427411],
 [-0.39394437],
 [ 0.43955638],
 [-4.1257611 ],
 [-1.77866263],
 [ 0.78441099],
 [ 1.87820034],
 [-0.89967432],
 [-3.83320828],
 [-0.89850342],
 [ 3.1044209 ],
 [-1.46918893],
 [-0.97616759]])

b[2] = np.array([[-0.34909961],
 [ 0.26103024],
 [-0.2947409 ],
 [ 1.37306608],
 [ 1.32507467],
 [ 0.76897449],
 [ 0.21597032],
 [-0.2550564 ],
 [-0.01925104],
 [ 0.4899793 ],
 [-0.09145294],
 [-1.30354412],
 [-0.48848271],
 [ 3.87278454],
 [ 0.07864629],
 [-0.21111361],
 [-0.02164162],
 [ 2.67479644],
 [ 1.89902098],
 [-0.05843121]])

b[3] = np.array([[ 0.15539394]])

activation_fun = {'forward': leaky_relu, 'backward': leaky_relu_backward}

sanity_check(L, W, b, activation_fun, function_to_estimate.function1)
print_metrics(layers, W, b, activation_fun)
